{"version":3,"file":"hc-mutual-credit.es5.js","sources":["../src/graphql/queries.ts","../src/elements/sharedStyles.ts","../src/elements/hcmc-create-offer.ts","../src/utils.ts","../src/elements/hcmc-pending-offer-list.ts","../src/elements/hcmc-transaction-list.ts","../src/graphql/schema.ts","../src/bindings.ts","../src/graphql/resolvers.ts","../src/elements/hcmc-offer-detail.ts","../src/types.ts","../src/elements/hcmc-allowed-creditor-list.ts","../src/mutual-credit.module.ts"],"sourcesContent":["import gql from 'graphql-tag';\n\nexport const GET_MY_BALANCE = gql`\n  query GetMyBalance {\n    me {\n      id\n      balance\n    }\n  }\n`;\n\nexport const GET_MY_TRANSACTIONS = gql`\n  query GetMyTransactions {\n    me {\n      id\n      transactions {\n        id\n        debtor {\n          id\n          username\n        }\n        creditor {\n          id\n          username\n        }\n        amount\n        timestamp\n      }\n    }\n  }\n`;\n\nexport const GET_PENDING_OFFERS = gql`\n  query GetPendingOffers {\n    me {\n      id\n      offers {\n        id\n        transaction {\n          id\n          debtor {\n            id\n            username\n          }\n          creditor {\n            id\n            username\n          }\n          amount\n          timestamp\n        }\n        state\n      }\n    }\n  }\n`;\n\nexport const GET_OFFER_DETAIL = gql`\n  query GetOfferDetail($transactionId: String!) {\n    me {\n      id\n    }\n\n    offer(transactionId: $transactionId) {\n      id\n      transaction {\n        id\n        debtor {\n          id\n          username\n        }\n        creditor {\n          id\n          username\n        }\n        amount\n        timestamp\n      }\n\n      counterpartySnapshot {\n        executable\n        valid\n        balance\n        lastHeaderId\n      }\n\n      state\n    }\n  }\n`;\n\nexport const CREATE_OFFER = gql`\n  mutation CreateOffer($creditorId: ID!, $amount: Float!) {\n    createOffer(creditorId: $creditorId, amount: $amount)\n  }\n`;\n\nexport const CONSENT_FOR_OFFER = gql`\n  mutation ConsentForOffer($transactionId: ID!) {\n    consentForOffer(transactionId: $transactionId)\n  }\n`;\n\nexport const ACCEPT_OFFER = gql`\n  mutation AcceptOffer($transactionId: ID!, $approvedHeaderId: ID!) {\n    acceptOffer(\n      transactionId: $transactionId\n      approvedHeaderId: $approvedHeaderId\n    )\n  }\n`;\n\nexport const CANCEL_OFFER = gql`\n  mutation CancelOffer($transactionId: ID!) {\n    cancelOffer(transactionId: $transactionId)\n  }\n`;\n","import { css } from 'lit-element';\n\nexport const sharedStyles = css`\n  .column {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .row {\n    display: flex;\n    flex-direction: row;\n  }\n\n  .placeholder {\n    opacity: 0.7;\n  }\n\n  .fill {\n    flex: 1;\n  }\n\n  .center-content {\n    justify-content: center;\n    align-items: center;\n  }\n\n  .item {\n    margin-bottom: 16px;\n  }\n\n  .padding {\n    padding: 16px;\n  }\n\n  .title {\n    font-weight: bold;\n    font-size: 18px;\n  }\n`;\n","import { moduleConnect } from '@uprtcl/micro-orchestrator';\nimport { LitElement, html, property, query, PropertyValues } from 'lit-element';\nimport { ApolloClient } from 'apollo-boost';\nimport { ApolloClientModule } from '@uprtcl/graphql';\nimport { CREATE_OFFER } from 'src/graphql/queries';\n\nimport '@material/mwc-textfield';\nimport '@material/mwc-button';\nimport { TextFieldBase } from '@material/mwc-textfield/mwc-textfield-base';\nimport { sharedStyles } from './sharedStyles';\nimport { Agent } from 'holochain-profiles';\n\nexport class MCCreateOffer extends moduleConnect(LitElement) {\n  @query('#amount')\n  amountField!: TextFieldBase;\n\n  @query('#creditor')\n  creditorField!: TextFieldBase;\n\n  @property({ type: Boolean })\n  open: boolean = false;\n\n  @property({ type: String })\n  creditor: Agent | undefined = undefined;\n\n  client!: ApolloClient<any>;\n\n  static get styles() {\n    return sharedStyles;\n  }\n\n  firstUpdated() {\n    this.client = this.request(ApolloClientModule.bindings.Client);\n\n    this.amountField.validityTransform = (newValue) => {\n      this.requestUpdate();\n      try {\n        const amount = parseFloat(newValue);\n        if (amount > 0) return { valid: true };\n      } catch (e) {}\n      this.amountField.setCustomValidity(\n        `Offer amount has to be greater than 0`\n      );\n      return {\n        valid: false,\n      };\n    };\n  }\n\n  async createOffer() {\n    const creditorId = this.creditorField.value;\n    const amount = parseFloat(this.amountField.value);\n    await this.client.mutate({\n      mutation: CREATE_OFFER,\n      variables: {\n        creditorId,\n        amount,\n      },\n    });\n\n    this.dispatchEvent(\n      new CustomEvent('offer-created', {\n        detail: { creditorId, amount },\n        composed: true,\n        bubbles: true,\n      })\n    );\n  }\n\n  render() {\n    return html`\n      <mwc-dialog\n        .open=${this.open}\n        @closed=${() => (this.open = false)}\n        heading=\"Create New Offer\"\n      >\n        <div class=\"column center-content\">\n          <span>\n            You are about to create an offer\n            ${this.creditor ? `to @${this.creditor.username}` : ''}, which would\n            lower your balance by the amount of the transaction and raise the\n            creditor's value by the same amount.\n            <br /><br />\n            This will let the creditor scan your source chain to validate your\n            transaction history.\n          </span>\n          <mwc-textfield\n            .disabled=${this.creditor !== undefined}\n            .value=${this.creditor && this.creditor.id}\n            style=\"padding: 16px 0; width: 24em;\"\n            id=\"creditor\"\n            label=\"Creditor\"\n            autoValidate\n            outlined\n          ></mwc-textfield>\n\n          <mwc-textfield\n            style=\"padding-top: 16px;\"\n            label=\"Amount\"\n            type=\"number\"\n            id=\"amount\"\n            min=\"0.1\"\n            step=\"0.1\"\n            autoValidate\n            outlined\n          ></mwc-textfield>\n        </div>\n\n        <mwc-button slot=\"secondaryAction\" dialogAction=\"cancel\">\n          Cancel\n        </mwc-button>\n        <mwc-button\n          .disabled=${!this.amountField || !this.amountField.validity.valid}\n          slot=\"primaryAction\"\n          @click=${() => this.createOffer()}\n          dialogAction=\"create\"\n        >\n          Create Offer\n        </mwc-button>\n      </mwc-dialog>\n    `;\n  }\n}\n","export function dateString(timestamp: number): string {\n  return `${new Date(timestamp * 1000).toLocaleTimeString().substring(0, 5)}h,\n                  ${new Date(timestamp * 1000).toDateString()}`;\n}\n","import { LitElement, html, property, css } from 'lit-element';\nimport { ApolloClient } from 'apollo-boost';\nimport { moduleConnect } from '@uprtcl/micro-orchestrator';\nimport { ApolloClientModule } from '@uprtcl/graphql';\n\nimport '@material/mwc-list';\nimport '@authentic/mwc-circular-progress';\n\nimport { GET_PENDING_OFFERS } from '../graphql/queries';\nimport { Offer } from 'src/types';\nimport { sharedStyles } from './sharedStyles';\nimport { Agent } from 'holochain-profiles';\nimport { dateString } from 'src/utils';\n\nexport class MCPendingOfferList extends moduleConnect(LitElement) {\n  client!: ApolloClient<any>;\n\n  @property({ type: String })\n  myAgentId!: string;\n\n  @property({ type: Object, attribute: false })\n  offers!: Offer[];\n\n  @property({ type: String })\n  lastSelectedOfferId: string | undefined = undefined;\n\n  static get styles() {\n    return [\n      sharedStyles,\n      css`\n        :host {\n          display: flex;\n        }\n      `,\n    ];\n  }\n\n  async firstUpdated() {\n    this.client = this.request(ApolloClientModule.bindings.Client);\n\n    this.client\n      .watchQuery({\n        query: GET_PENDING_OFFERS,\n        fetchPolicy: 'network-only',\n      })\n      .subscribe((result) => {\n        this.myAgentId = result.data.me.id;\n        this.offers = result.data.me.offers.filter(\n          (offer) => offer.state !== 'Completed' && offer.state !== 'Canceled'\n        );\n      });\n  }\n\n  renderPlaceholder(type: string) {\n    return html`<span style=\"padding-top: 16px;\">\n      You have no ${type.toLowerCase()} offers\n    </span>`;\n  }\n\n  offerSelected(transactionId: string) {\n    this.dispatchEvent(\n      new CustomEvent('offer-selected', {\n        detail: { transactionId, composed: true, bubbles: true },\n      })\n    );\n    this.lastSelectedOfferId = transactionId;\n  }\n\n  isOutgoing(offer: Offer): boolean {\n    return offer.transaction.debtor.id === this.myAgentId;\n  }\n\n  getOutgoing(): Offer[] {\n    return this.offers.filter((offer) => this.isOutgoing(offer));\n  }\n\n  getIncoming(): Offer[] {\n    return this.offers.filter((offer) => !this.isOutgoing(offer));\n  }\n\n  counterparty(offer: Offer): Agent {\n    return offer.transaction.creditor.id === this.myAgentId\n      ? offer.transaction.debtor\n      : offer.transaction.creditor;\n  }\n\n  renderOfferList(title: string, offers: Offer[]) {\n    return html`<div class=\"column\">\n      <span class=\"title\">${title} offers</span>\n\n      ${offers.length === 0\n        ? this.renderPlaceholder(title)\n        : html`\n            <mwc-list>\n              ${offers.map(\n                (offer, index) => html`\n                  <mwc-list-item\n                    @click=${() => this.offerSelected(offer.id)}\n                    graphic=\"avatar\"\n                    twoline\n                    .activated=${this.lastSelectedOfferId &&\n                    this.lastSelectedOfferId === offer.id}\n                  >\n                    <span>\n                      ${offer.transaction.amount} credits\n                      ${this.isOutgoing(offer) ? 'to' : 'from'}\n                      @${this.counterparty(offer).username}\n                    </span>\n                    <span slot=\"secondary\">\n                      ${dateString(offer.transaction.timestamp)}\n                    </span>\n                    <mwc-icon\n                      slot=\"graphic\"\n                      .style=\"color: ${this.isOutgoing(offer)\n                        ? 'red'\n                        : 'green'}\"\n                      >${this.isOutgoing(offer)\n                        ? 'call_made'\n                        : 'call_received'}</mwc-icon\n                    >\n                  </mwc-list-item>\n                  ${index < this.offers.length - 1\n                    ? html`<li divider padded role=\"separator\"></li> `\n                    : html``}\n                `\n              )}\n            </mwc-list>\n          `}\n    </div>`;\n  }\n\n  render() {\n    if (!this.offers)\n      return html`<div class=\"column fill center-content\">\n        <mwc-circular-progress></mwc-circular-progress>\n        <span class=\"placeholder\" style=\"margin-top: 18px;\"\n          >Fetching pending offers...</span\n        >\n      </div>`;\n\n    return html`<div class=\"column fill\">\n      <div style=\"margin-bottom: 24px;\">\n        ${this.renderOfferList('Incoming', this.getIncoming())}\n      </div>\n      ${this.renderOfferList('Outgoing', this.getOutgoing())}\n    </div>`;\n  }\n}\n","import { LitElement, property, html } from 'lit-element';\nimport { ApolloClient } from 'apollo-boost';\n\nimport { ApolloClientModule } from '@uprtcl/graphql';\nimport { moduleConnect } from '@uprtcl/micro-orchestrator';\n\nimport '@material/mwc-top-app-bar';\nimport '@material/mwc-list';\nimport '@authentic/mwc-circular-progress';\n\nimport { GET_MY_TRANSACTIONS } from '../graphql/queries';\nimport { Transaction } from '../types';\nimport { Agent } from 'holochain-profiles';\nimport { sharedStyles } from './sharedStyles';\nimport { dateString } from 'src/utils';\n\nexport class MCTransactionList extends moduleConnect(LitElement) {\n  @property({ type: String })\n  myAgentId!: string;\n\n  @property({ type: Object, attribute: false })\n  transactions!: Array<Transaction>;\n\n  static get styles() {\n    return sharedStyles;\n  }\n\n  async firstUpdated() {\n    const client: ApolloClient<any> = this.request(\n      ApolloClientModule.bindings.Client\n    );\n    const result = await client.query({\n      query: GET_MY_TRANSACTIONS,\n      fetchPolicy: 'network-only',\n    });\n\n    this.myAgentId = result.data.me.id;\n    this.transactions = result.data.me.transactions.sort(\n      (t1, t2) => t2.timestamp - t1.timestamp\n    );\n  }\n\n  isOutgoing(transaction: Transaction) {\n    return transaction.debtor.id === this.myAgentId;\n  }\n\n  getCounterparty(transaction: Transaction): Agent {\n    return transaction.creditor.id === this.myAgentId\n      ? transaction.debtor\n      : transaction.creditor;\n  }\n\n  render() {\n    return html`<div class=\"column center-content\">\n      ${this.renderContent()}\n    </div>`;\n  }\n\n  renderContent() {\n    if (!this.transactions)\n      return html`\n        <div class=\"padding center-content column\">\n          <mwc-circular-progress></mwc-circular-progress>\n          <span class=\"placeholder\" style=\"margin-top: 18px;\"\n            >Fetching transaction history...</span\n          >\n        </div>\n      `;\n\n    if (this.transactions.length === 0)\n      return html`<div class=\"padding\">\n        <span>You have no transactions in your history</span>\n      </div>`;\n\n    return html`\n      <mwc-list style=\"width: 100%;\">\n        ${this.transactions.map(\n          (transaction, i) => html`\n            <div class=\"row\" style=\"align-items: center;\">\n              <mwc-list-item\n                twoline\n                noninteractive\n                graphic=\"avatar\"\n                style=\"flex: 1;\"\n              >\n                <span>\n                  ${this.isOutgoing(transaction) ? 'To ' : 'From '}\n                  @${this.getCounterparty(transaction).username} on\n                  ${dateString(transaction.timestamp)}\n                </span>\n                <span slot=\"secondary\"\n                  >${this.getCounterparty(transaction).id}\n                </span>\n                <mwc-icon\n                  slot=\"graphic\"\n                  .style=\"color: ${this.isOutgoing(transaction)\n                    ? 'red'\n                    : 'green'}\"\n                  >${this.isOutgoing(transaction)\n                    ? 'call_made'\n                    : 'call_received'}</mwc-icon\n                >\n              </mwc-list-item>\n\n              <span style=\"font-size: 20px; margin-right: 24px;\">\n                ${this.isOutgoing(transaction) ? '-' : '+'}${transaction.amount}\n                credits\n              </span>\n            </div>\n            ${i < this.transactions.length - 1\n              ? html`<li divider padded role=\"separator\"></li> `\n              : html``}\n          `\n        )}\n      </mwc-list>\n    `;\n  }\n}\n","import gql from 'graphql-tag';\n\nexport const mutualCreditTypeDefs = gql`\n  scalar Date\n\n  enum OfferState {\n    Received\n    Pending\n    Canceled\n    Approved\n    Completed\n  }\n\n  type Transaction {\n    id: ID!\n\n    debtor: Agent!\n    creditor: Agent!\n    amount: Float!\n    timestamp: Date!\n  }\n\n  type CounterpartySnapshot {\n    executable: Boolean!\n    balance: Float!\n    valid: Boolean!\n    lastHeaderId: ID!\n  }\n\n  type Offer {\n    id: ID!\n\n    transaction: Transaction!\n\n    counterpartySnapshot: CounterpartySnapshot\n\n    state: OfferState!\n  }\n\n  extend type Me {\n    transactions: [Transaction!]!\n    offers: [Offer!]!\n    balance: Float!\n  }\n\n  extend type Query {\n    offer(transactionId: ID!): Offer!\n  }\n\n  extend type Mutation {\n    createOffer(creditorId: ID!, amount: Float!): ID!\n    consentForOffer(transactionId: ID!): ID!\n    cancelOffer(transactionId: ID!): ID!\n    acceptOffer(transactionId: ID!, approvedHeaderId: ID!): ID!\n  }\n`;\n","export const MutualCreditBindings = {\n  MutualCreditProvider: 'mutual-credit-provider',\n  ValidAgentFilter: 'valid-agent-filter',\n};\n","import { HolochainProvider } from '@uprtcl/holochain-provider';\n\nimport { MutualCreditBindings } from '../bindings';\n\nfunction offerToTransaction(id, offer) {\n  const state = offer.state;\n  return {\n    id,\n    transaction: {\n      id,\n      ...offer.transaction,\n    },\n    state: typeof state === 'object' ? Object.keys(state)[0] : state,\n  };\n}\n\nexport const resolvers = {\n  Transaction: {\n    creditor(parent) {\n      return { id: parent.creditor_address };\n    },\n    debtor(parent) {\n      return { id: parent.debtor_address };\n    },\n  },\n  Offer: {\n    async counterpartySnapshot(parent, _, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      try {\n        const snapshot = await mutualCreditProvider.call(\n          'get_counterparty_snapshot',\n          {\n            transaction_address: parent.id,\n          }\n        );\n        return snapshot;\n      } catch (e) {\n        if (e.message.includes('Offer is not pending')) return null;\n      }\n    },\n  },\n  CounterpartySnapshot: {\n    lastHeaderId(parent) {\n      return parent.last_header_address;\n    },\n  },\n  Query: {\n    async offer(_, { transactionId }, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      const offer = await mutualCreditProvider.call('query_offer', {\n        transaction_address: transactionId,\n      });\n      return offerToTransaction(transactionId, offer);\n    },\n  },\n  Me: {\n    async transactions(_, __, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      const transactions = await mutualCreditProvider.call(\n        'query_my_transactions',\n        {}\n      );\n      return transactions.map((t) => ({ id: t[0], ...t[1] }));\n    },\n    async offers(_, __, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      const offers = await mutualCreditProvider.call('query_my_offers', {});\n      console.log(offers);\n      return offers.map((offer) => offerToTransaction(offer[0], offer[1]));\n    },\n    async balance(_, __, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      const result = await mutualCreditProvider.call('query_my_balance', {});\n      return result.hasOwnProperty('Ok') ? result.Ok : result;\n    },\n  },\n  Mutation: {\n    async createOffer(_, { creditorId, amount }, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      return mutualCreditProvider.call('create_offer', {\n        creditor_address: creditorId,\n        amount,\n        timestamp: Math.floor(Date.now() / 1000),\n      });\n    },\n    async acceptOffer(_, { transactionId, approvedHeaderId }, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      await mutualCreditProvider.call('accept_offer', {\n        transaction_address: transactionId,\n        approved_header_address: approvedHeaderId,\n      });\n\n      return transactionId;\n    },\n    async consentForOffer(_, { transactionId }, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      await mutualCreditProvider.call('consent_for_offer', {\n        transaction_address: transactionId,\n      });\n\n      return transactionId;\n    },\n    async cancelOffer(_, { transactionId }, { container }) {\n      const mutualCreditProvider: HolochainProvider = container.get(\n        MutualCreditBindings.MutualCreditProvider\n      );\n\n      await mutualCreditProvider.call('cancel_offer', {\n        transaction_address: transactionId,\n      });\n\n      return transactionId;\n    },\n  },\n};\n","import { moduleConnect } from '@uprtcl/micro-orchestrator';\nimport { LitElement, html, property, css, PropertyValues } from 'lit-element';\nimport { sharedStyles } from './sharedStyles';\nimport { Offer } from 'src/types';\nimport { ApolloClientModule } from '@uprtcl/graphql';\nimport { ApolloClient, gql } from 'apollo-boost';\nimport {\n  GET_OFFER_DETAIL,\n  ACCEPT_OFFER,\n  CANCEL_OFFER,\n  GET_PENDING_OFFERS,\n  CONSENT_FOR_OFFER,\n} from 'src/graphql/queries';\nimport { Agent } from 'holochain-profiles';\nimport { dateString } from 'src/utils';\n\nexport class MCOfferDetail extends moduleConnect(LitElement) {\n  @property({ type: String })\n  transactionId!: string;\n\n  @property({ type: String })\n  myAgentId!: string;\n\n  @property({ type: Object })\n  offer!: Offer;\n\n  @property({ type: Boolean })\n  accepting: boolean = false;\n\n  @property({ type: Boolean })\n  consenting: boolean = false;\n\n  @property({ type: Boolean })\n  canceling: boolean = false;\n\n  client!: ApolloClient<any>;\n\n  static get styles() {\n    return sharedStyles;\n  }\n\n  updated(changedValues: PropertyValues) {\n    super.updated(changedValues);\n\n    if (changedValues.has('transactionId') && this.transactionId !== null) {\n      this.loadOffer();\n    }\n  }\n\n  async loadOffer() {\n    this.offer = undefined as any;\n    this.client = this.request(ApolloClientModule.bindings.Client);\n\n    const result = await this.client.query({\n      query: GET_OFFER_DETAIL,\n      variables: {\n        transactionId: this.transactionId,\n      },\n      fetchPolicy: 'network-only',\n    });\n\n    this.offer = result.data.offer;\n    this.myAgentId = result.data.me.id;\n  }\n\n  acceptOffer() {\n    this.accepting = true;\n\n    this.client\n      .mutate({\n        mutation: ACCEPT_OFFER,\n        variables: {\n          transactionId: this.transactionId,\n          approvedHeaderId: this.offer.counterpartySnapshot.lastHeaderId,\n        },\n        update: (cache, result) => {\n          const pendingOffers: any = cache.readQuery({\n            query: GET_PENDING_OFFERS,\n          });\n\n          pendingOffers.me.offers.find((o) => o.id === this.offer.id).state =\n            'Completed';\n\n          cache.writeQuery({\n            query: GET_PENDING_OFFERS,\n            data: pendingOffers,\n          });\n        },\n      })\n      .then(() => {\n        this.dispatchEvent(\n          new CustomEvent('offer-accepted', {\n            detail: { transactionId: this.transactionId },\n            composed: true,\n            bubbles: true,\n          })\n        );\n      })\n      .finally(() => (this.accepting = false));\n  }\n\n  consentOffer() {\n    this.consenting = true;\n\n    this.client\n      .mutate({\n        mutation: CONSENT_FOR_OFFER,\n        variables: {\n          transactionId: this.transactionId,\n        },\n      })\n      .then(() => {\n        this.dispatchEvent(\n          new CustomEvent('offer-consented', {\n            detail: { transactionId: this.transactionId },\n            composed: true,\n            bubbles: true,\n          })\n        );\n        this.loadOffer();\n      })\n      .finally(() => (this.consenting = false));\n  }\n\n  async cancelOffer() {\n    (this.canceling = true),\n      await this.client.mutate({\n        mutation: CANCEL_OFFER,\n        variables: {\n          transactionId: this.transactionId,\n        },\n        update: (cache, result) => {\n          const pendingOffers: any = cache.readQuery({\n            query: GET_PENDING_OFFERS,\n          });\n\n          const offers = pendingOffers.me.offers.filter(\n            (o) => o.id !== this.transactionId\n          );\n\n          pendingOffers.me.offers = offers;\n\n          cache.writeQuery({ query: GET_PENDING_OFFERS, data: pendingOffers });\n        },\n      });\n\n    this.dispatchEvent(\n      new CustomEvent('offer-canceled', {\n        detail: { transactionId: this.transactionId },\n        bubbles: true,\n        composed: true,\n      })\n    );\n  }\n\n  isOutgoing() {\n    return this.offer.transaction.debtor.id === this.myAgentId;\n  }\n\n  getCounterparty(): Agent {\n    return this.offer.transaction.creditor.id === this.myAgentId\n      ? this.offer.transaction.debtor\n      : this.offer.transaction.creditor;\n  }\n\n  renderCounterparty() {\n    const cUsername = `@${this.getCounterparty().username}`;\n    return html`\n      <div class=\"row\">\n        <div class=\"column\">\n          <span class=\"item title\">\n            Offer ${this.isOutgoing() ? ' to ' : ' from '} ${cUsername}\n          </span>\n          <span class=\"item\">Agend ID: ${this.getCounterparty().id}</span>\n\n          <span class=\"item\">\n            Transaction amount: ${this.offer.transaction.amount} credits\n          </span>\n          <span class=\"item\">\n            Date: ${dateString(this.offer.transaction.timestamp)}\n          </span>\n\n          <span class=\"item title\" style=\"margin-top: 16px;\"\n            >${cUsername} current status</span\n          >\n\n          ${this.offer.counterpartySnapshot\n            ? html`\n                <span class=\"item\">\n                  Balance: ${this.offer.counterpartySnapshot.balance} credits\n                </span>\n                <span class=\"item\">\n                  Transaction history is\n                  ${this.offer.counterpartySnapshot.valid ? 'valid' : 'invalid'}\n                </span>\n                <span class=\"item\">\n                  Offer is\n                  ${this.offer.counterpartySnapshot.executable ? '' : 'not'}\n                  executable right now\n                </span>\n              `\n            : html`\n                <span class=\"item\">\n                  ${this.offer.state !== 'Received'\n                    ? `${cUsername} has `\n                    : 'You have '}\n                  not consented for to share\n                  ${this.offer.state !== 'Received' ? 'their' : 'your'} source\n                  chain yet\n                </span>\n              `}\n        </div>\n      </div>\n    `;\n  }\n\n  placeholderMessage() {\n    if (this.accepting) return 'Accepting offer...';\n    if (this.canceling) return 'Canceling offer...';\n    if (this.consenting) return 'Consenting for offer...';\n    return 'Fetching and verifying counterparty chain...';\n  }\n\n  renderOfferForwardAction() {\n    if (this.isOutgoing())\n      return html`<mwc-button\n        style=\"flex: 1;\"\n        .label=\"Awaiting for ${this.offer.counterpartySnapshot\n          ? 'approval'\n          : 'consent'}\"\n        disabled\n        raised\n      >\n      </mwc-button>`;\n    if (this.offer.state == 'Received')\n      return html`<mwc-button\n        style=\"flex: 1;\"\n        label=\"CONSENT TO SHOW CHAIN\"\n        raised\n        @click=${() => this.consentOffer()}\n      ></mwc-button>`;\n    return html`\n      <mwc-button\n        style=\"flex: 1;\"\n        .disabled=${!this.offer.counterpartySnapshot.executable ||\n        this.offer.state !== 'Pending'}\n        label=\"ACCEPT AND COMPLETE TRANSACTION\"\n        raised\n        @click=${() => this.acceptOffer()}\n      ></mwc-button>\n    `;\n  }\n\n  render() {\n    if (!this.offer || this.accepting || this.canceling || this.consenting)\n      return html`<div class=\"column fill center-content\">\n        <mwc-circular-progress></mwc-circular-progress>\n        <span style=\"margin-top: 18px;\" class=\"placeholder\">${this.placeholderMessage()}</span>\n      </div>`;\n\n    return html`\n      <div class=\"column\">\n        ${this.renderCounterparty()}\n        <div class=\"row center-content\" style=\"margin-top: 24px;\">\n          <mwc-button\n            label=\"CANCEL OFFER\"\n            style=\"flex: 1; margin-right: 16px;\"\n            @click=${() => this.cancelOffer()}\n          ></mwc-button>\n          ${this.renderOfferForwardAction()}\n        </div>\n      </div>\n    `;\n  }\n}\n","import { Agent } from 'holochain-profiles';\nimport { ApolloClient, gql } from 'apollo-boost';\n\nexport const allAgentsAllowed: GetAllowedCreditors = async (client) => {\n  const result = await client.query({\n    query: gql`\n      {\n        allAgents {\n          id\n          username\n        }\n      }\n    `,\n  });\n\n  return result.data.allAgents;\n};\n\nexport type GetAllowedCreditors = (\n  client: ApolloClient<any>\n) => Promise<Agent[]>;\n\nexport interface Transaction {\n  id: string;\n\n  debtor: Agent;\n  creditor: Agent;\n  amount: number;\n  timestamp: number;\n}\n\nexport interface CounterpartySnapshot {\n  valid: boolean;\n  executable: boolean;\n  balance: number;\n  lastHeaderId: string;\n}\n\nexport interface Offer {\n  id: string;\n\n  transaction: Transaction;\n  state: string;\n\n  counterpartySnapshot: CounterpartySnapshot;\n}\n","import { moduleConnect } from '@uprtcl/micro-orchestrator';\nimport { LitElement, html, query, property } from 'lit-element';\nimport { ApolloClient, gql } from 'apollo-boost';\n\nimport { Agent } from 'holochain-profiles';\nimport { Dialog } from '@material/mwc-dialog';\nimport { ApolloClientModule } from '@uprtcl/graphql';\n\nimport { MutualCreditBindings } from '../bindings';\nimport { GetAllowedCreditors } from '../types';\nimport { sharedStyles } from './sharedStyles';\nimport { MCCreateOffer } from './hcmc-create-offer';\n\nexport class MCAllowedCreditorList extends moduleConnect(LitElement) {\n  @query('#create-offer-dialog')\n  createOfferDialog!: MCCreateOffer;\n\n  @property({ type: Object })\n  selectedCreditor: Agent | undefined = undefined;\n\n  @property({ type: Array })\n  agents: Agent[] | undefined = undefined;\n\n  client!: ApolloClient<any>;\n\n  static get styles() {\n    return sharedStyles;\n  }\n\n  async firstUpdated() {\n    this.client = this.request(ApolloClientModule.bindings.Client);\n\n    const getAllowedCreditors: GetAllowedCreditors = this.request(\n      MutualCreditBindings.ValidAgentFilter\n    );\n\n    const agents = await getAllowedCreditors(this.client);\n\n    const result = await this.client.query({\n      query: gql`\n        {\n          me {\n            id\n          }\n        }\n      `,\n    });\n\n    this.agents = agents.filter((a) => a.id !== result.data.me.id);\n  }\n\n  renderCreateOffer() {\n    return html`\n      <hcmc-create-offer\n        id=\"create-offer-dialog\"\n        .creditor=${this.selectedCreditor}\n        @offer-created=${() => (this.createOfferDialog.open = false)}\n      >\n      </hcmc-create-offer>\n    `;\n  }\n\n  renderAgent(agent: Agent) {\n    return html`\n      <div class=\"row\" style=\"align-items: center;\">\n        <mwc-list-item style=\"flex: 1;\" twoline noninteractive graphic=\"avatar\">\n          <span>@${agent.username}</span>\n          <span slot=\"secondary\">${agent.id}</span>\n          <mwc-icon slot=\"graphic\">person</mwc-icon>\n        </mwc-list-item>\n\n        <mwc-button\n          label=\"Offer credits\"\n          style=\"padding-right: 16px;\"\n          outlined\n          @click=${() => {\n            this.selectedCreditor = agent;\n            this.createOfferDialog.open = true;\n          }}\n        >\n          <mwc-icon style=\"padding-top: 3px;\" slot=\"trailingIcon\">send</mwc-icon>\n        </mwc-button>\n      </div>\n    `;\n  }\n\n  render() {\n    return html`<div class=\"column center-content\">\n      ${this.renderContent()}\n    </div>`;\n  }\n\n  renderContent() {\n    if (!this.agents)\n      return html`<div class=\"padding center-content\">\n        <mwc-circular-progress></mwc-circular-progress>\n      </div>`;\n\n    if (this.agents.length === 0)\n      return html`<div class=\"padding\">\n        <span>There are no agents to which to offer credits</span>\n      </div>`;\n\n    return html`\n      ${this.renderCreateOffer()}\n      <mwc-list style=\"width: 100%;\">\n        ${this.agents.map(\n          (agent, i) => html`${this.renderAgent(agent)}\n          ${this.agents && i < this.agents.length - 1\n            ? html`<li divider padded role=\"separator\"></li> `\n            : html``} `\n        )}\n      </mwc-list>\n    `;\n  }\n}\n","import { interfaces } from 'inversify';\nimport { GraphQlSchemaModule } from '@uprtcl/graphql';\nimport { MicroModule, i18nextModule } from '@uprtcl/micro-orchestrator';\nimport {\n  HolochainConnectionModule,\n  createHolochainProvider,\n} from '@uprtcl/holochain-provider';\nimport { ProfilesModule } from 'holochain-profiles';\n\nimport { MCCreateOffer } from './elements/hcmc-create-offer';\nimport { MCPendingOfferList } from './elements/hcmc-pending-offer-list';\nimport { MCTransactionList } from './elements/hcmc-transaction-list';\n\nimport en from './i18n/en.json';\nimport { mutualCreditTypeDefs } from './graphql/schema';\nimport { MutualCreditBindings } from './bindings';\nimport { resolvers } from './graphql/resolvers';\nimport { MCOfferDetail } from './elements/hcmc-offer-detail';\nimport { GetAllowedCreditors, allAgentsAllowed } from './types';\nimport { MCAllowedCreditorList } from './elements/hcmc-allowed-creditor-list';\n\nexport class MutualCreditModule extends MicroModule {\n  static id = 'mutual-credit-module';\n\n  dependencies = [HolochainConnectionModule.id, ProfilesModule.id];\n\n  static bindings = MutualCreditBindings;\n\n  constructor(\n    protected instance: string,\n    protected agentFilter: GetAllowedCreditors = allAgentsAllowed\n  ) {\n    super();\n  }\n\n  async onLoad(container: interfaces.Container) {\n    const mutualCreditProvider = createHolochainProvider(\n      this.instance,\n      'transactor'\n    );\n\n    container\n      .bind(MutualCreditBindings.MutualCreditProvider)\n      .to(mutualCreditProvider);\n\n    container\n      .bind(MutualCreditBindings.ValidAgentFilter)\n      .toConstantValue(this.agentFilter);\n\n    customElements.define('hcmc-transaction-list', MCTransactionList);\n    customElements.define('hcmc-create-offer', MCCreateOffer);\n    customElements.define('hcmc-pending-offer-list', MCPendingOfferList);\n    customElements.define('hcmc-offer-detail', MCOfferDetail);\n    customElements.define('hcmc-allowed-creditor-list', MCAllowedCreditorList);\n  }\n\n  get submodules() {\n    return [\n      new GraphQlSchemaModule(mutualCreditTypeDefs, resolvers),\n      new i18nextModule('mutual-credit', { en: en }),\n    ];\n  }\n}\n"],"names":["gql"],"mappings":"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"}